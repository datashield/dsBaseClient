<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generates non-disclosive scatter plots — ds.scatterPlot • dsBaseClient</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generates non-disclosive scatter plots — ds.scatterPlot"><meta property="og:description" content="This function uses two disclosure control methods to generate non-disclosive
scatter plots of two server-side continuous variables."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dsBaseClient</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">6.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generates non-disclosive scatter plots</h1>

    <div class="hidden name"><code>ds.scatterPlot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function uses two disclosure control methods to generate non-disclosive
scatter plots of two server-side continuous variables.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ds.scatterPlot</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"deterministic"</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  noise <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"split"</span>,</span>
<span>  return.coords <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  datasources <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a character string specifying the name of the explanatory variable, a numeric vector.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>a character string specifying the name of the response variable,  a numeric vector.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>a character string that specifies the
method that is used to generated non-disclosive
coordinates to be displayed in a scatter plot.
This argument can be set as <code>'deteministic'</code> or <code>'probabilistic'</code>.
Default <code>'deteministic'</code>.
For more information see <strong>Details</strong>.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>the number of the nearest neighbours  for which their centroid is calculated.
Default 3.
For more information see <strong>Details</strong>.</p></dd>


<dt id="arg-noise">noise<a class="anchor" aria-label="anchor" href="#arg-noise"></a></dt>
<dd><p>the percentage of the initial variance that is used as the variance of the embedded
noise if the argument <code>method</code> is set to <code>'probabilistic'</code>.
For more information see <strong>Details</strong>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>a character that represents the type of graph to display.
This can be set as <code>'combine'</code> or <code>'split'</code>.
Default <code>'split'</code>.
For more information see <strong>Details</strong>.</p></dd>


<dt id="arg-return-coords">return.coords<a class="anchor" aria-label="anchor" href="#arg-return-coords"></a></dt>
<dd><p>a logical. If TRUE the coordinates of the anonymised data points are return
to the Console. Default value is FALSE.</p></dd>


<dt id="arg-datasources">datasources<a class="anchor" aria-label="anchor" href="#arg-datasources"></a></dt>
<dd><p>a list of <code><a href="https://datashield.github.io/DSI/reference/DSConnection-class.html" class="external-link">DSConnection-class</a></code> objects obtained after login.
If the <code>datasources</code> argument is not specified
the default set of connections will be used: see <code><a href="https://datashield.github.io/DSI/reference/datashield.connections_default.html" class="external-link">datashield.connections_default</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>ds.scatterPlot</code> returns to the client-side one or more scatter
plots depending on the argument <code>type</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>As the generation of a scatter plot from original data is disclosive and is not
permitted in DataSHIELD, this function allows the user to plot non-disclosive scatter plots.</p>
<p>If the argument <code>method</code> is set to <code>'deterministic'</code>, the server-side function searches
for the <code>k-1</code> nearest neighbours of each single data point and calculates the centroid
of such <code>k</code> points.
The proximity is defined by the minimum Euclidean distances of z-score transformed data.</p>
<p>When the coordinates of all centroids are estimated the function applies scaling to expand the
centroids back to the dispersion of the original data. The scaling is achieved by multiplying
the centroids with a scaling factor that is equal to the ratio between the standard deviation of
the original variable and the standard deviation of the calculated centroids. The coordinates of
the scaled centroids are then returned to the client-side.</p>
<p>The value of <code>k</code> is specified by the user.
The suggested and default value is equal to 3 which is also
the suggested minimum threshold that is used to prevent disclosure which is specified in the
protection filter <code>nfilter.kNN</code>. When the value of <code>k</code> increases,
the disclosure risk decreases but the utility loss increases.
The value of <code>k</code> is used only
if the argument <code>method</code> is set to <code>'deterministic'</code>.
Any value of <code>k</code> is ignored if the
argument <code>method</code> is set to <code>'probabilistic'</code>.</p>
<p>If the argument <code>method</code> is set to <code>'probabilistic'</code>,
the server-side function generates a random normal noise of zero mean
and variance equal to 10% of the variance of each <code>x</code> and <code>y</code> variable.
The noise is added to each <code>x</code> and <code>y</code> variable and the disturbed by the addition of
<code>noise</code> data are returned to the client-side. Note that the seed random number generator is fixed to a
specific number generated from the data and therefore the user gets the same figure every time
that chooses the probabilistic method in a given set of variables.
The value of <code>noise</code> is used only if the argument <code>method</code> is set to <code>'probabilistic'</code>.
Any value of <code>noise</code> is ignored if
the argument <code>method</code> is set to <code>'deterministic'</code>.</p>
<p>In <code>type</code> argument can be set two graphics to display:<br>
(1) If <code>type = 'combine'</code>  a scatter plot for
combined data is generated.<br>
(2) If <code>type = 'split'</code>  one scatter plot for each
study is generated.</p>
<p>Server function called: <code>scatterPlotDS</code></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>DataSHIELD Development Team</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## Version 6, for version 5 see the Wiki </span></span></span>
<span class="r-in"><span>  <span class="co"># Connecting to the Opal servers</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/datashield/DSI/" class="external-link">'DSI'</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/datashield/DSOpal/" class="external-link">'DSOpal'</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">'dsBaseClient'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">builder</span> <span class="op">&lt;-</span> <span class="fu">DSI</span><span class="fu">::</span><span class="fu"><a href="https://datashield.github.io/DSI/reference/newDSLoginBuilder.html" class="external-link">newDSLoginBuilder</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">builder</span><span class="op">$</span><span class="fu">append</span><span class="op">(</span>server <span class="op">=</span> <span class="st">"study1"</span>, </span></span>
<span class="r-in"><span>                 url <span class="op">=</span> <span class="st">"http://192.168.56.100:8080/"</span>, </span></span>
<span class="r-in"><span>                 user <span class="op">=</span> <span class="st">"administrator"</span>, password <span class="op">=</span> <span class="st">"datashield_test&amp;"</span>, </span></span>
<span class="r-in"><span>                 table <span class="op">=</span> <span class="st">"CNSIM.CNSIM1"</span>, driver <span class="op">=</span> <span class="st">"OpalDriver"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">builder</span><span class="op">$</span><span class="fu">append</span><span class="op">(</span>server <span class="op">=</span> <span class="st">"study2"</span>, </span></span>
<span class="r-in"><span>                 url <span class="op">=</span> <span class="st">"http://192.168.56.100:8080/"</span>, </span></span>
<span class="r-in"><span>                 user <span class="op">=</span> <span class="st">"administrator"</span>, password <span class="op">=</span> <span class="st">"datashield_test&amp;"</span>, </span></span>
<span class="r-in"><span>                 table <span class="op">=</span> <span class="st">"CNSIM.CNSIM2"</span>, driver <span class="op">=</span> <span class="st">"OpalDriver"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">builder</span><span class="op">$</span><span class="fu">append</span><span class="op">(</span>server <span class="op">=</span> <span class="st">"study3"</span>,</span></span>
<span class="r-in"><span>                 url <span class="op">=</span> <span class="st">"http://192.168.56.100:8080/"</span>, </span></span>
<span class="r-in"><span>                 user <span class="op">=</span> <span class="st">"administrator"</span>, password <span class="op">=</span> <span class="st">"datashield_test&amp;"</span>, </span></span>
<span class="r-in"><span>                 table <span class="op">=</span> <span class="st">"CNSIM.CNSIM3"</span>, driver <span class="op">=</span> <span class="st">"OpalDriver"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">logindata</span> <span class="op">&lt;-</span> <span class="va">builder</span><span class="op">$</span><span class="fu">build</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Log onto the remote Opal training servers</span></span></span>
<span class="r-in"><span>  <span class="va">connections</span> <span class="op">&lt;-</span> <span class="fu">DSI</span><span class="fu">::</span><span class="fu"><a href="https://datashield.github.io/DSI/reference/datashield.login.html" class="external-link">datashield.login</a></span><span class="op">(</span>logins <span class="op">=</span> <span class="va">logindata</span>, assign <span class="op">=</span> <span class="cn">TRUE</span>, symbol <span class="op">=</span> <span class="st">"D"</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Example 1: generate a scatter plot for each study separately</span></span></span>
<span class="r-in"><span>  <span class="co">#Using the default deterministic method and k = 10</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu">ds.scatterPlot</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"D$PM_BMI_CONTINUOUS"</span>,</span></span>
<span class="r-in"><span>                 y <span class="op">=</span> <span class="st">"D$LAB_GLUC_ADJUSTED"</span>,</span></span>
<span class="r-in"><span>                 method <span class="op">=</span> <span class="st">"deterministic"</span>,</span></span>
<span class="r-in"><span>                 k <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                 type <span class="op">=</span> <span class="st">"split"</span>,</span></span>
<span class="r-in"><span>                 datasources <span class="op">=</span> <span class="va">connections</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Example 2: generate a combined scatter plot with the probabilistic method</span></span></span>
<span class="r-in"><span>  <span class="co">#and noise of variance 0.5% of the variable's variance, and display the coordinates</span></span></span>
<span class="r-in"><span>  <span class="co"># of the anonymised data points to the Console</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu">ds.scatterPlot</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"D$PM_BMI_CONTINUOUS"</span>,</span></span>
<span class="r-in"><span>                 y <span class="op">=</span> <span class="st">"D$LAB_GLUC_ADJUSTED"</span>,</span></span>
<span class="r-in"><span>                 method <span class="op">=</span> <span class="st">"probabilistic"</span>,</span></span>
<span class="r-in"><span>                 noise <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                 type <span class="op">=</span> <span class="st">"combine"</span>,</span></span>
<span class="r-in"><span>                 datasources <span class="op">=</span> <span class="va">connections</span><span class="op">)</span></span></span>
<span class="r-in"><span>                   </span></span>
<span class="r-in"><span>  <span class="co">#Clear the Datashield R sessions and logout</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://datashield.github.io/DSI/reference/datashield.logout.html" class="external-link">datashield.logout</a></span><span class="op">(</span><span class="va">connections</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Paul Burton, Rebecca Wilson, Olly Butters, Patricia Ryser-Welch, Alex Westerberg, Leire Abarrategui, Roberto Villegas-Diaz, Demetris Avraam, Demetris Avraam, Yannick Marcon, Tom Bishop, Amadou Gaye, Xavier Escribà-Montagut, Stuart Wheater.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

